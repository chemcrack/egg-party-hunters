import{d as j,r as f,o as O,c as d,a as C,b as i,w as R,e as t,n as g,t as S,_ as N,F as x,f as A,g as z,u as ee,h as P,i as Y,j as X,k as v,l as te,v as oe,m as ae,p as le,S as se}from"./index-Bv8EmkSt.js";let V=null;const ne=async()=>{try{return"wakeLock"in navigator?(V=await navigator.wakeLock.request("screen"),console.log("屏幕常亮锁已激活"),V.addEventListener("release",()=>{console.log("屏幕常亮锁已释放"),V=null}),!0):(console.warn("当前浏览器不支持 Wake Lock API"),!1)}catch(b){return console.error("请求屏幕常亮锁失败:",b),!1}};function re(){return{copyToClipboard:async n=>{if(!n||typeof n!="string")return console.error("复制失败：需要复制的内容必须是非空字符串"),!1;try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(n),!0;const r=document.createElement("textarea");r.value=n,r.style.position="fixed",r.style.top="-9999px",r.style.left="-9999px",document.body.appendChild(r),r.focus(),r.select();const u=document.execCommand("copy");if(document.body.removeChild(r),!u)throw new Error("execCommand copy failed");return!0}catch(r){return console.error("复制失败：",r),!1}}}}const ie={key:0,class:"message"},ue=["src"],ce={class:"viewer-toolbar"},de={class:"viewer-controls"},ve=j({__name:"MapView",emits:["close"],setup(b,{expose:n,emit:r}){const u=f({url:"",degree:0,visible:!1,alt:"",link:""}),h=f({visible:!1});n({open:(l,s,y,T)=>{ne(),E(),u.value.alt=y,u.value.link=T,u.value.url=l,u.value.degree=s,u.value.visible=!0}});const _=r,p=async()=>{re().copyToClipboard(u.value.link),h.value.visible=!0,setTimeout(()=>{h.value.visible=!1},5e3)},k=f(null),c=f({x:0,y:0,scale:1,rotate:0}),$=f({SCALE_MAX:3,SCALE_MIN:.5,SCALE:1,ROTATE:0}),w=f(!1),D=f(0),e=f(0),m=f(0),o=f(1),a=()=>{u.value.visible=!1,_("close")},E=()=>{c.value={x:0,y:0,scale:$.value.SCALE,rotate:$.value.ROTATE}},L=()=>{if(!k.value)return;const l=window.innerWidth,s=window.innerHeight,y=l>s?k.value.naturalWidth:k.value.naturalHeight,T=l>s?k.value.naturalHeight:k.value.naturalWidth,Q=l/y,Z=s/T,W=Math.min(Q,Z);$.value={SCALE:W,SCALE_MAX:W*5,SCALE_MIN:W*.5,ROTATE:l>s?0:90},c.value={x:0,y:0,scale:$.value.SCALE,rotate:$.value.ROTATE+u.value.degree}},M=l=>{let s=c.value.rotate+l;c.value.rotate=(s+360)%360},B=l=>{const s=c.value.scale+l;s>=$.value.SCALE_MIN&&s<=$.value.SCALE_MAX&&(c.value.scale=s)},U=l=>{l.preventDefault();const s=l.deltaY>0?-.1:.1;B(s)},G=l=>{w.value=!0,D.value=l.clientX-c.value.x,e.value=l.clientY-c.value.y,document.addEventListener("mousemove",F),document.addEventListener("mouseup",I)},F=l=>{w.value&&(c.value.x=l.clientX-D.value,c.value.y=l.clientY-e.value)},I=()=>{w.value=!1,document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",I)},J=l=>{l.touches.length===1&&l.touches[0]?(w.value=!0,D.value=l.touches[0].clientX-c.value.x,e.value=l.touches[0].clientY-c.value.y):l.touches.length===2&&(m.value=q(l),o.value=c.value.scale)},K=l=>{if(!(!w.value&&l.touches.length!==2)){if(l.touches.length===1&&l.touches[0])c.value.x=l.touches[0].clientX-D.value,c.value.y=l.touches[0].clientY-e.value;else if(l.touches.length===2){const y=q(l)/m.value,T=o.value*y;T>=$.value.SCALE_MIN&&T<=$.value.SCALE_MAX&&(c.value.scale=T)}}},q=l=>{if(l.touches.length>1&&l.touches[0]&&l.touches[1]){const s=l.touches[1].clientX-l.touches[0].clientX,y=l.touches[1].clientY-l.touches[0].clientY;return Math.sqrt(s*s+y*y)}return 0};return O(()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",I)}),(l,s)=>u.value.visible?(i(),d("div",{key:0,class:"image-viewer-mask",onClick:R(a,["self"]),onTouchmove:R(K,["prevent"])},[h.value.visible?(i(),d("div",ie,"本地图链接已经复制！")):C("",!0),t("button",{class:"close-btn control-btn",onClick:s[0]||(s[0]=y=>a())},"×"),t("img",{ref_key:"imageRef",ref:k,src:u.value.url,alt:"",class:"viewer-image",style:g({transform:`translate(${c.value.x}px, ${c.value.y}px) scale(${c.value.scale}) rotate(${c.value.rotate}deg)`,transition:w.value?"none":"transform 0.2s ease"}),onLoad:L,onMousedown:G,onTouchstart:J,onWheel:U,onClick:s[1]||(s[1]=R(()=>{},["stop"]))},null,44,ue),t("div",ce,[t("div",de,[t("button",{class:"control-btn",style:{"background-color":"#C19A6B"},onClick:s[2]||(s[2]=y=>B(.1))},"+"),t("button",{class:"control-btn",style:{"background-color":"#C19A6B"},onClick:s[3]||(s[3]=y=>B(-.1))},"-"),t("button",{class:"control-btn",onClick:s[4]||(s[4]=y=>p())},""),t("button",{class:"control-btn",style:{"background-color":"#D8ABAB"},onClick:s[5]||(s[5]=y=>M(90))},"↻"),t("button",{class:"control-btn",style:{"background-color":"#D8ABAB"},onClick:s[6]||(s[6]=y=>M(-90))},"↺"),t("button",{class:"control-btn",onClick:E},"⟲")]),t("div",null,S(u.value.alt),1)])],32)):C("",!0)}}),ge=N(ve,[["__scopeId","data-v-b8274a49"]]),me="/wechat1.jpg",fe="/wechat2.jpg",pe={class:"help"},he={class:"content"},ye={key:0,class:"text"},ke=j({__name:"help2",setup(b,{expose:n}){const r=f(null);return n({init:u=>{r.value=u}}),(u,h)=>(i(),d("div",pe,[h[0]||(h[0]=t("h1",null,"蛋仔派对 惊魂寻宝队 地图",-1)),h[1]||(h[1]=t("ul",{class:"wechat"},[t("li",null,[t("div",null,[t("img",{src:me,alt:"蛋仔派对惊魂寻宝队地图 公众号"})]),t("div",null,"蛋仔派对惊魂寻宝队地图 公众号")]),t("li",null,[t("div",null,[t("img",{src:fe,alt:"蛋仔派对惊魂寻宝队地图 小程序"})]),t("div",null,"蛋仔派对惊魂寻宝队地图 小程序")])],-1)),h[2]||(h[2]=t("h2",null,"小抄使用说明",-1)),r.value?(i(),d(x,{key:0},[t("h2",null,S(r.value.title),1),t("div",he,[(i(!0),d(x,null,A(r.value.content,_=>(i(),d(x,null,[t("h3",null,S(_.topic),1),(i(!0),d(x,null,A(_.body,p=>(i(),d(x,null,[p.t=="text"&&p.v?(i(),d("div",ye,S(p.v),1)):C("",!0),p.t=="style"&&p.v?(i(),d("div",{key:1,class:"img1",style:g(p.v)},null,4)):C("",!0)],64))),256))],64))),256))])],64)):C("",!0)]))}}),De={class:"info"},Ce=j({__name:"info",setup(b){const n={info:[{name:"window宽高",value:window.innerWidth+" "+window.innerHeight},{name:"内容区域",value:document.documentElement.clientWidth+" "+document.documentElement.clientHeight}]};return(r,u)=>(i(!0),d(x,null,A(n.info,(h,_)=>(i(),d("dl",De,[t("dt",null,S(_+1)+". "+S(h.name),1),t("dd",null,S(h.value),1)]))),256))}}),Se={},$e={for:"doorSwitch",class:"gate-toggle"};function we(b,n){return i(),d("label",$e,[...n[0]||(n[0]=[t("div",{class:"toggle-bg"},null,-1),t("div",{class:"toggle-options"},[t("div",{class:"toggle-option"},"正门"),t("div",{class:"toggle-option"},"侧门")],-1)])])}const be=N(Se,[["render",we]]),_e={class:"egg"},xe={class:"sort",style:{background:"rgba(255,255,255,0.1)"}},Ee={class:"mainDoor sortButton"},Te={style:{display:"inline-flex","margin-right":"0.8em"}},Le={style:{display:"inline-flex"}},Ae={key:0,class:"sort",style:{"background-color":"#001E36"}},je={class:"mainDoor sortButton"},Me={key:1,class:"sort",style:{"background-color":"#333"}},Be={class:"sideDoor sortButton"},Xe={key:2},Fe=["onClick"],Ie={class:"path"},H="/party/",We=j({__name:"MapList",async setup(b){let n,r;const u={image:H+"images/A",thumbnail:H+"thumbnail/T",link:"https://party.0chem.com/?id="},h=([n,r]=z(()=>fetch(H+"party2.json")),n=await n,r(),n),_=([n,r]=z(()=>h.json()),n=await n,r(),n),p=f(null),k=f(),c=f();p.value=_.data;const w=ee().query.id;let D=f([]);const e={info:f(),imageData:f({show:0,groupId:0,index:0,url:"",degree:0,doorType:!1,doorSelect:0}),mainEntrance:function(m,o){if(e.imageData.value.show=1,e.imageData.value.doorSelect=o,D.value=[{group:"其他",color:"white",item:[]},{group:"挨着红房间",color:"#32CD32",item:[]},{group:"特殊",color:"#00FFFF",item:[]}],p.value!=null)for(let a of p.value)a.doorMain.sort==m&&D.value[a.doorMain.groupId-1]?.item.push({url:a.id,ext:a.ext,doorStyle:"left",date:a.date,degree:a.doorMain.degree})},sideEntrance:function(m,o){if(e.imageData.value.show=1,e.imageData.value.doorSelect=o,D.value=[{group:"一般",color:"white",item:[]},{group:"进门是红房",color:"#32CD32",item:[]},{group:"挨着楼梯或红房",color:"#00FFFF",item:[]},{group:"特殊",color:"yellow",item:[]}],p.value!=null)for(let a of p.value)a.doorSide.sort==m&&D.value[a.doorSide.groupId-1]?.item.push({url:a.id,ext:a.ext,doorStyle:"right",date:a.date,degree:a.doorSide.degree})},selectDoor:m=>{e.imageData.value.degree=m},imageClick:(m,o)=>{const a=D.value[m]?.item[o];if(a){let E=u.image+a.url+a.ext;k.value&&(console.log("image"),k.value.open(E,a.degree+e.imageData.value.degree,"更新于 "+a.date,u.link+a.url))}},imageClose:()=>{e.imageData.value.show=1}};return P(()=>{if(c.value&&c.value.init(_.help),w&&w.length==3&&p.value!=null){for(let m of p.value)if(m.id===w){let o=u.image+m.id+m.ext;k.value&&(console.log("image"),k.value.open(o,0,"更新于 "+m.date,u.link+m.id))}}}),(m,o)=>(i(),d("div",_e,[t("div",xe,[o[22]||(o[22]=t("div",{class:"sortTag"},"选择门",-1)),t("div",Ee,[o[20]||(o[20]=t("div",{class:"autoHide"},"门的方向",-1)),t("div",Te,[t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.degree==0}]),onClick:o[0]||(o[0]=a=>e.selectDoor(0))},"",2),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.degree==180}]),onClick:o[1]||(o[1]=a=>e.selectDoor(180))},"",2),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.degree==90}]),onClick:o[2]||(o[2]=a=>e.selectDoor(90))},"",2),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.degree==-90}]),onClick:o[3]||(o[3]=a=>e.selectDoor(-90))},"",2)]),o[21]||(o[21]=t("div",{class:"autoHide"},"那个门",-1)),t("div",Le,[te(t("input",{type:"checkbox",id:"doorSwitch","onUpdate:modelValue":o[4]||(o[4]=a=>e.imageData.value.doorType=a),class:"gate-toggle-checkbox"},null,512),[[oe,e.imageData.value.doorType]]),X(be)])])]),e.imageData.value.doorType?C("",!0):(i(),d("div",Ae,[o[23]||(o[23]=t("div",{class:"sortTag"},"正门：根据正门和出口关系",-1)),t("div",je,[t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==101}]),onClick:o[5]||(o[5]=a=>e.mainEntrance("1up",101)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==102}]),onClick:o[6]||(o[6]=a=>e.mainEntrance("1left",102)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==103}]),onClick:o[7]||(o[7]=a=>e.mainEntrance("1right",103)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==104}]),onClick:o[8]||(o[8]=a=>e.mainEntrance("2horizontal",104)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==105}]),onClick:o[9]||(o[9]=a=>e.mainEntrance("2left_up",105)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==106}]),onClick:o[10]||(o[10]=a=>e.mainEntrance("2right_up",106)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==107}]),onClick:o[11]||(o[11]=a=>e.mainEntrance("3down",107)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6)])])),e.imageData.value.doorType?(i(),d("div",Me,[o[24]||(o[24]=t("div",{class:"sortTag"},"侧门：根据侧门所在空间的形状",-1)),t("div",null,[t("div",Be,[t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==201}]),onClick:o[12]||(o[12]=a=>e.sideEntrance("square",201)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==202}]),onClick:o[13]||(o[13]=a=>e.sideEntrance("horizontal",202)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==203}]),onClick:o[14]||(o[14]=a=>e.sideEntrance("vertical",203)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==204}]),onClick:o[15]||(o[15]=a=>e.sideEntrance("left_up",204)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==205}]),onClick:o[16]||(o[16]=a=>e.sideEntrance("left_down",205)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==206}]),onClick:o[17]||(o[17]=a=>e.sideEntrance("right_up",206)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==207}]),onClick:o[18]||(o[18]=a=>e.sideEntrance("right_down",207)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6),t("a",{href:"javascript:void(0)",class:v(["sortTitle select",{doorSelect:e.imageData.value.doorSelect==208}]),onClick:o[19]||(o[19]=a=>e.sideEntrance("h_ladder",208)),style:g({transform:`rotate(${e.imageData.value.degree}deg)`})},"",6)])])])):C("",!0),e.imageData.value.show>0?(i(),d("div",Xe,S(e.info.value),1)):C("",!0),e.imageData.value.show>0?(i(!0),d(x,{key:3},A(ae(D),(a,E)=>(i(),d("div",null,[t("div",{class:"title",style:g({color:a.color})},S(E+1)+". "+S(a.group),5),t("ul",null,[(i(!0),d(x,null,A(a.item,(L,M)=>(i(),d("li",{class:"itemSelect",style:g({borderColor:a.color,backgroundImage:`url(${u.thumbnail+L.url}.webp)`,backgroundSize:"200%",backgroundPosition:`${L.doorStyle} center`,transform:`rotate(${e.imageData.value.degree}deg)`}),onClick:B=>e.imageClick(E,M)},[t("span",Ie,S(L.url),1)],12,Fe))),256))])]))),256)):C("",!0),e.imageData.value.show==99?(i(),Y(Ce,{key:4})):C("",!0),X(ge,{ref_key:"imageView",ref:k,onClose:e.imageClose},null,8,["onClose"]),e.imageData.value.show>=0?(i(),Y(ke,{key:5,ref_key:"helpView",ref:c},null,512)):C("",!0)]))}}),Re={};function Ve(b,n){return i(),d("footer",null,[...n[0]||(n[0]=[t("div",{class:"copy_right"},null,-1)])])}const He=N(Re,[["render",Ve]]),Ne=j({__name:"index",setup(b){const n=r=>{r.preventDefault()};return P(()=>{document.addEventListener("contextmenu",n)}),O(()=>{document.removeEventListener("contextmenu",n)}),(r,u)=>(i(),d(x,null,[(i(),Y(se,null,{default:le(()=>[X(We)]),_:1})),X(He)],64))}});export{Ne as default};
